{% autoescape false %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta content="True" name="HandheldFriendly">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=auto;">
  <meta name="theme-color" content="#fff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#1c1c1e" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="css/post.css">
  <link rel="stylesheet" href="css/highlight.css">
  <title>{{ title }}</title>

  <meta property="og:type" content="article" />
  <meta property="og:title" content="{{ title }}" />
  <meta property="og:site_name" content="{{ site_name }}" />
  <meta property="og:description" content="{{ description }}" />
  <meta property="article:published_time" content="{{ published_time }}" />
  <meta property="og:image" content="{{ image }}" />
  <meta property="og:image:alt" content="{{ image_alt }}" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="{{ site_url }}" />
  <meta name="twitter:title" content="{{ title }}" />
  <meta name="twitter:description" content="{{ description }}" />
  <meta name="twitter:image" content="{{ image }}" />
  <script>
    function breadcrumb(stubs) {
      let container = document.createElement('div');
      container.classList.add('breadcrumb')
      let inner = document.createElement('div');
      inner.classList.add('breadcrumb-inner');
      container.appendChild(inner);
      if (!stubs || !stubs.length) {
        return;
      }

      const getStubElem = (stub) => {
        let elem;
        if (stub.url) {
          elem = document.createElement('a');
          elem.href = stub.url;
        } else {
          elem = document.createElement('span');
        }
        elem.innerText = stub.text;
        if (stub.classes) {
          elem.classList.add(...stub.classes);
        }
        return elem;
      };

      const getSeparatorElem = () => {
        let elem = document.createElement('span');
        elem.innerText = 'â€º';
        elem.classList.add("chevron");
        return elem;
      }

      inner.append(getStubElem(stubs[0]));
      inner.append(getSeparatorElem());
      for (let i = 1; i < stubs.length; i++)  {
        inner.append(getStubElem(stubs[i]));
        if (i < stubs.length - 1) {
          inner.append(getSeparatorElem());
        }
      }

      let main = document.querySelector('.wrapper');
      main.insertAdjacentElement('afterbegin', container);
    }
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if(document.getElementById('audio-container')){
        document.querySelector('.audio-container').style.display = 'block';
      }
      if(document.getElementById('footer')){
        document.querySelector('#footer').style.display = 'block';
      }
      breadcrumb([
        { text: "{{ site_name }}", url: '../' },
        { text: "{{ title }}", url: './' },
      ]);
    });
  </script>
  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>
</head>
<body>
<div class="wrapper">
  <div class="main">
    <h1>{{ title }}</h1>
    <div class="date">{{ date }}</div>
    <div class="content">
      {{ content }}
    </div>
    <div id="gitalk-container"></div>
    <footer id="footer" style="display: none;">
      <div class="footer-inner">
        Designed By V2EX. Generated By EvanLuo42's Blog Engine.
      </div>
    </footer>
  </div>
</div>
</body>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: "{{ client_id }}",
    clientSecret: "{{ client_secret }}",
    repo: "{{ repo }}",
    owner: "{{ owner }}",
    admin: ["{{ owner }}"],
    id: decodeURI(location.pathname).slice(0, 49),
  });
  gitalk.render('gitalk-container');
</script>
</html>
{% endautoescape %}
